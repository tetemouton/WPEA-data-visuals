dat_pth <- "C:/GitRep/ALB-converter/Convert-project/data/"
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
tp <- sqlTables(mycon) # to see all the tables in the VMS database
tp
view(tp)
vday.tb <- sqlColumns(mycon, "dbo.vms_day")
vday.tb
vesinst.tb <- sqlColumns(mycon, "dbo.vessel_instances")
vesinst.tb <- sqlColumns(mycon, "ref.vessel_instances")
vesinst.tb
23000*.01
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessel_instances vs on vm.vessel_id = vs.vessel_id", max = 0, stringsAsFactors = FALSE)
head(vms_dat)
dim(vms_dat)
table(vms_dat$log_act_code)
vday.tb
vesinst.tb <- sqlColumns(mycon, "ref.vessel")
tp
vesinst.tb <- sqlColumns(mycon, "ref.vessels")
vesinst.tb
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id", max = 0, stringsAsFactors = FALSE)
head(vms_dat)
table(vms_dat$gear)
table(vms_dat$gear,useNA = "always")
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id ", max = 0, stringsAsFactors = FALSE)
head(vms_dat)
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
428+286
head(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' AND vm.mean_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' AND vm.mean_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
head(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
head(vms_dat)
dim(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT *,
year(vms_date) AS yr,
month(vms_date) AS mon,
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
vms_dat
vms_dat <- sqlQuery(mycon, "SELECT *,
year(vms_date) AS yr,
month(vms_date) AS mon
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
vms_dat <- sqlQuery(mycon, "SELECT *,
year(vm.vms_date) AS yr,
month(vm.vms_date) AS mon
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
vms_dat
vms_dat <- sqlQuery(mycon, "SELECT *,
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
vms_dat <- sqlQuery(mycon, "SELECT *,
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
vms_dat
vms_dat <- sqlQuery(mycon, "SELECT *
FROM vms_day vm
inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
vms_dat
vms_dat <- sqlQuery(mycon, "SELECT * FROM vms_day vm inner join ref.vessels vs on vm.vessel_id = vs.vessel_id WHERE vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
vms_dat <- sqlQuery(mycon, "SELECT *, year(vm.vms_date) AS yr
FROM vms_day vm inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' AND vm.main_eez_code = 'FJ' ", max = 0, stringsAsFactors = FALSE)
dim(vms_dat)
head(vms_dat)
vms_tab <- vms_d %>% filter(log_act_code == "F") %>% group_by(yr, vessel_id, vms_date) %>% summarise(N_unique = n()) %>%
group_by(yr, vessel_id) %>% summarise(N_days = n())
vms_tab <- vms_dat %>% filter(log_act_code == "F") %>% group_by(yr, vessel_id, vms_date) %>% summarise(N_unique = n()) %>%
group_by(yr, vessel_id) %>% summarise(N_days = n())
vms_tab
vms_N_ves <- vms_tab %>% filter(N_days >= 10) %>% group_by(yr) %>% summarise(N_ves = n())
vms_N_ves
vms_tab
23000*.27+22607*.14+15300+.96+10500*.58+9000*.56+8499*.28
23000*.27+22607*.14+15300+.97+10500*.58+9000*.58+8499*.28
vms_N_ves <- vms_tab %>% filter(N_days >= 5) %>% group_by(yr) %>% summarise(N_ves = n())
vms_N_ves
vms_N_ves <- vms_tab %>% filter(N_days >= 1) %>% group_by(yr) %>% summarise(N_ves = n())
vms_N_ves
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=log_master;
Trusted_Connection=yes;")
tp <- sqlTables(mycon) # to see all the tables in the observer database
cat.tb <- sqlColumns(mycon, "log.catch_ll")
set.tb <- sqlColumns(mycon, "log.sets_ll")
trp.tb <- sqlColumns(mycon, "log.trips_ll")
ves.tb <- sqlColumns(mycon, "ref.vessel_instances")
ls_dat <- sqlQuery(mycon, "SELECT
lt.log_trip_id,
lv.vessel_id,
lv.vessel_instance_id,
lv.vesselname,
lv.vesselname_normalised,
lv.old_vessel_id,
lv.flag_id,
lv.flag_rg_id,
lt.depart_date,
ls.LOG_SET_ID,
ls.logdate,
day(ls.logdate) AS dy,
month(ls.logdate) AS mon,
year(ls.logdate) AS yr,
ls.lat,
ls.lon,
ref.getlatdfromlat(ls.lat) as latd,
ref.getlondfromlon(ls.lon) as lond,
ls.l_activity_id,
ls.eez_code,
ls.set_no,
ls.hook,
ls.hk_bt_flt_n,
lc.SP_CODE,
lc.SP_N,
lc.SP_KG
FROM	log.trips_ll lt
left outer join log.sets_ll ls on  lt.log_trip_id = ls.LOG_TRIP_ID
left outer join log.catch_ll lc on  ls.LOG_SET_ID = lc.LOG_SET_ID
inner join ref.vessel_instances lv on lt.vessel_id = lv.old_vessel_id
WHERE ref.getlatdfromlat(ls.lat) < 0",
stringsAsFactors = FALSE)
dim(ls_dat)
save(ls_dat, file = paste0(dat_pth, "LS_Dat_logmaster.RData"))
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
tp <- sqlTables(mycon) # to see all the tables in the VMS database
vday.tb <- sqlColumns(mycon, "dbo.vms_day")
vesinst.tb <- sqlColumns(mycon, "ref.vessels")
vms_d <- sqlQuery(mycon, "SELECT *, year(vm.vms_date) AS yr
FROM vms_day vm inner join ref.vessels vs on vm.vessel_id = vs.vessel_id
WHERE vs.gear = 'L' ", max = 0, stringsAsFactors = FALSE)
dim(vms_d)
save(vms_d, file = paste0(dat_pth, "VMS_Dat_vmsday.RData"))
shiny::runApp('C:/GitRep/ALB-converter/Shinyapp')
4000*3000
1000000
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
library(RODBC)
dat_pth <- "C:/GitRep/ALB-converter/Convert-project/data/"
runApp('C:/GitRep/ALB-converter/Shinyapp')
library(RODBC)
dat_pth <- "C:/GitRep/ALB-converter/Convert-project/data/"
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
tp <- sqlTables(mycon) # to see all the tables in the VMS database
view(tp)
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE eez_code = 'FJ' AND gear = 'L' GROUP BY v.vessel_id, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE gear = 'L' GROUP BY v.vessel_id, eez_code, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
veff.tb <- sqlColumns(mycon, "vms_effort")
veff.tb
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, v.eez_code, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE gear = 'L' GROUP BY v.vessel_id, v.eez_code, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, e.eez_code, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE gear = 'L' GROUP BY v.vessel_id, e.eez_code, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
dim(vms_d)
save(vms_d, file = paste0(dat_pth, "VMS_Dat_vmsday.RData"))
vms_d %>% filter(eez_code == "FJ", days_fishing >= 10) %>% group_by(year) %>% summarise(Nves = n())
runApp('C:/GitRep/ALB-converter/Shinyapp')
dat_pth
runApp('C:/GitRep/ALB-converter/Shinyapp')
library(ggplot2)
library(magrittr)
library(tidyverse)
library(grid)
library(lubridate)
library(data.table)
theme_set(theme_bw())
dirpth <- "C:/GitRep/ALB-converter/Convert-project"
fst_yr <- 1990
lst_yr <- 2021
#spa.cnt <- c("AS","AU","CK","FJ","HS","JV","KI","MA","NC","NU","NZ","PF","PG","SB","TK","TO","TV","VU","WF","WS")
#hs.vec <- c("H4","H5", paste0("I", 1:9))
# Dataframe to convert EEZ names among various formats
ez_convert <- read.csv(file = paste0(dirpth, "/Data/EZ_Converter.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the annual catch estimate data
ace_dat <- read.csv(file = paste0(dirpth, "/Data/ACE_Data_AllGears.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the VMS day aggregate data
load(paste0(dirpth, "/Data/VMS_Dat_vmsday.RData"), verbose = TRUE) # This is object vms_d
# Bring in the vessel licencing information
lic_dat <- read.csv(file = paste0(dirpth, "/Data/Vessel_License_Data.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the logmaster logsheet data
load(paste0(dirpth, "/Data/LS_Dat_logmaster.RData"), verbose = TRUE) # This is object ls_dat
cnt_vec <- c("AS","AU","CK","FJ","GL","H4","H5","I2","I5","I7","I8","I9","JV","KI","LN","MA",
"NC","NF","NU","NZ","PF","PG","PX","SB","TK","TO","TV","VU","WF","WS")
IW <- c("H4","H5","HB","I2","I5","I7","I8","I9")
cnt_sht <- c("AS","AU","CK","FJ","HS","JV","KI","NC","NU","NZ","PF","PG","SB","TK","TO","TV","VU","WF","WS")
full_tab <- expand.grid(Year = fst_yr:lst_yr, EEZ = cnt_sht)
head(vms_d)
table(vms_d$eez_code)
veff.tb
vms_sht <- vms_d %>% mutate(eez_code = ifelse(eez_code %in% IW, "HS", eez_code),
eez_code = ifelse(eez_code %in% c("GL","KI","LN","PX"), "KI", eez_code),
eez_code = ifelse(eez_code %in% c("MA","NC"), "NC", eez_code),
eez_code = ifelse(eez_code %in% c("AU","NF"), "AU", eez_code))
write.csv(vms_sht, file = paste0(dirpth, "/Data/VES_N_EEZ_YR_VMS.csv"), row.names = FALSE)
dim(vms_d)
mycon <- odbcDriverConnect(connection="driver=SQL Server;server=nouSQL03;database=vms;
Trusted_Connection=yes;")
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, e.eez_code, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE v.latitude < 0 AND gear = 'L' GROUP BY v.vessel_id, e.eez_code, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
vms_d <- sqlQuery(mycon, "SELECT v.vessel_id, e.eez_code, YEAR(date) year, SUM(day_fishing) days_fishing
FROM vms_effort e JOIN ref.vessels v ON e.vessel_id = v.vessel_id
WHERE e.latitude < 0 AND gear = 'L' GROUP BY v.vessel_id, e.eez_code, YEAR(date) ", max = 0, stringsAsFactors = FALSE)
head(vms_d)
dim(vms_d)
table(vms_d$eez_code)
save(vms_d, file = paste0(dat_pth, "VMS_Dat_vmsday.RData"))
library(ggplot2)
library(magrittr)
library(tidyverse)
library(grid)
library(lubridate)
library(data.table)
theme_set(theme_bw())
dirpth <- "C:/GitRep/ALB-converter/Convert-project"
fst_yr <- 1990
lst_yr <- 2021
#spa.cnt <- c("AS","AU","CK","FJ","HS","JV","KI","MA","NC","NU","NZ","PF","PG","SB","TK","TO","TV","VU","WF","WS")
#hs.vec <- c("H4","H5", paste0("I", 1:9))
# Dataframe to convert EEZ names among various formats
ez_convert <- read.csv(file = paste0(dirpth, "/Data/EZ_Converter.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the annual catch estimate data
ace_dat <- read.csv(file = paste0(dirpth, "/Data/ACE_Data_AllGears.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the VMS day aggregate data
load(paste0(dirpth, "/Data/VMS_Dat_vmsday.RData"), verbose = TRUE) # This is object vms_d
# Bring in the vessel licencing information
lic_dat <- read.csv(file = paste0(dirpth, "/Data/Vessel_License_Data.csv"), stringsAsFactors = FALSE, header = TRUE)
# Bring in the logmaster logsheet data
load(paste0(dirpth, "/Data/LS_Dat_logmaster.RData"), verbose = TRUE) # This is object ls_dat
cnt_vec <- c("AS","AU","CK","FJ","GL","H4","H5","I2","I5","I7","I8","I9","JV","KI","LN","MA",
"NC","NF","NU","NZ","PF","PG","PX","SB","TK","TO","TV","VU","WF","WS")
IW <- c("H4","H5","HB","I2","I5","I7","I8","I9")
cnt_sht <- c("AS","AU","CK","FJ","HS","JV","KI","NC","NU","NZ","PF","PG","SB","TK","TO","TV","VU","WF","WS")
full_tab <- expand.grid(Year = fst_yr:lst_yr, EEZ = cnt_sht)
table(vms_d)
table(vms_d$eez_code)
vms_sht <- vms_d %>% mutate(eez_code = ifelse(eez_code %in% IW, "HS", eez_code),
eez_code = ifelse(eez_code %in% c("GL","KI","LN","PX"), "KI", eez_code),
eez_code = ifelse(eez_code %in% c("MA","NC"), "NC", eez_code),
eez_code = ifelse(eez_code %in% c("AU","NF"), "AU", eez_code))
table(vms_sht$eez_code)
head(vms_sht)
vms_sht <- vms_d %>% mutate(eez_code = ifelse(eez_code %in% IW, "HS", eez_code),
eez_code = ifelse(eez_code %in% c("GL","KI","LN","PX"), "KI", eez_code),
eez_code = ifelse(eez_code %in% c("MA","NC"), "NC", eez_code),
eez_code = ifelse(eez_code %in% c("AU","NF"), "AU", eez_code)) %>%
group_by(vessel_id, eez_code, year) %>% summarise(days_fishing = sum(days_fishing))   # This line is just to allow aggregation of vessels due to pooling of some EEZs in lines above
write.csv(vms_sht, file = paste0(dirpth, "/Data/VES_N_EEZ_YR_VMS.csv"), row.names = FALSE)
runApp('C:/GitRep/ALB-converter/Shinyapp')
table(vms_sht$year)
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
320*80
320*80*5
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp()
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
library(DT)
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp()
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
tmp <- data.frame(Catch = c(72200,65000,57800,50600,43400,36100), Depletion = c(.43,.48,.53,.58,.63,.68))
windows()
plot(tmp$Catch,tmp$Depletion)
lm(tmp$Depletion,tmp$Catch)
lm(tmp$Depletion ~ tmp$Catch)
mod <- lm(tmp_reg$Depletion ~ tmp_reg$Catch)
tmp_reg <- data.frame(Catch = c(72200,65000,57800,50600,43400,36100), Depletion = c(.43,.48,.53,.58,.63,.68))
mod <- lm(tmp_reg$Depletion ~ tmp_reg$Catch)
?predict
predict(mod, data.frame(Catch = 54000))
mod$coefficients
mod$coefficients[1] + mod$coefficients[2]*54000
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
runApp('C:/GitRep/ALB-converter/Shinyapp')
(pl.base)
library(tidyverse)
library(magrittr)
library(xtable)
library(sf)
library(maps)
library(scatterpie)
library(lubridate)
library(grid)
library(gridExtra)
library(ggthemes)
theme_set(theme_bw())
dir.pth <- "C:/FSM_Request/2021_Maps/"
pna.cnt <- c("GL","KI","LN","MH","NR","PG","PW","PX","SB","TV")
# Catch maps
dat <- read.csv(file = paste0(dir.pth, "Data/PS_All flags FM EEZ_2010-2021.csv"))
eez <- st_read(paste0(dir.pth, "EEZ_Shape_Files/World_EEZ_v10_2018_0_360.shp"))
cnt.keep <- read.csv(file = "C:/South_Pacific_Albacore/Zone_Biomass_Calcs/Data/PacCountries.csv", header = TRUE)
world_shp_180 <- sf::st_as_sf(maps::map("world", wrap = c(0,360),  plot = FALSE, fill = TRUE))
pac.eez <- eez[eez$Territory1 %in% cnt.keep$Ctry,]
reg.bkd <- c("POLYGON((114 28,114 -18,150 -18,150 -5,125 -5,125 28,114 28))") %>%
st_as_sfc(crs=st_crs(eez)) %>% st_sf(field=c('x','y'), geoms = ., stringsAsFactors=FALSE)
windows(4000,2000)
pl.base <- ggplot() +
geom_sf(data = reg.bkd, fill = alpha("wheat", 0.99), size = 0.1) +
geom_sf(data = pac.eez, color = "black", size = 0.1) +
geom_sf(data = world_shp_180, fill = alpha("wheat", 0.99), size = 0.1) +
coord_sf(xlim = c(120,210), ylim = c(-15,25)) +
#coord_sf(xlim = c(130,180), ylim = c(-9,18)) +
xlab("Longitude") + ylab("Latitude") #+ theme_map()
print(pl.base)
for(t in c("16","17","18","19","20","21")){
psall <- read.csv(file = paste0(dir.pth, "Data/PS_All EEZ_20", t, ".csv"))
ves.keep <- c("TAIYO CHUUK","TAIYO PALIKIR","TAIYO POHNPEI","TAIYO TOFOL","TAIYO WAAB")
pl.dat <- psall %>% filter(vessel_name %in% ves.keep) %>%
mutate(Vessel = vessel_name, Zone = ifelse(eez_code %in% pna.cnt, "PNA", "Other"), Zone = ifelse(eez_code == "FM", "FSM", Zone),
lond = ifelse(lond < 0, lond + 360, lond))
windows(4000,2000)
pl <- pl.base + geom_point(data = pl.dat, aes(x = lond, y = latd, fill = Zone, colour = Zone), shape = 21) + ggtitle(paste0("TMC 20", t)) +
scale_fill_manual(values = alpha(c("magenta","blue","red"), 0.2)) + scale_colour_manual(values = alpha(c("magenta","blue","red"), 0.9))
print(pl)
savePlot(file = paste0(dir.pth, "/Plots/TMC/PS_20", t, "_TMC.png"), type = "png")
pl <- pl + coord_sf(xlim = c(130,180), ylim = c(-9,18))
print(pl)
savePlot(file = paste0(dir.pth, "/Plots/TMC/PS_20", t, "_TMC_cls.png"), type = "png")
pl <- pl.base + geom_point(data = pl.dat, aes(x = lond, y = latd, colour = Vessel)) + theme(legend.position = "top") + ggtitle(paste0("TMC 20", t))
print(pl)
savePlot(file = paste0(dir.pth, "/Plots/TMC/PS_20", t, "_TMC_ByVesselTogether.png"), type = "png")
dev.off()
windows(4000,3000)
pl <- pl.base + geom_point(data = pl.dat, aes(x = lond, y = latd, colour = Vessel)) +
facet_wrap(~ vessel_name, ncol = 2) + theme(legend.position = "top") + ggtitle(paste0("TMC 20", t))
print(pl)
savePlot(file = paste0(dir.pth, "/Plots/TMC/PS_20", t, "_TMC_ByVessel.png"), type = "png")
dev.off()
}
780000*.025
load(paste0(dir.pth, "data/spa_weighted_median_sbsbf0.RData"), verbose = TRUE)
setwd("C:/R_Courses/RAW/ACE_data")
dat <- read.csv("Annual_Catch_Estimates.csv")
head(dat)
my_eez <- filter(dat, eez == "pg")
my_eez <- filter(dat, eez == "PG")
head(dat)
my_eez <- filter(data = dat, eez == "PG")
my_eez <- dat %>% filter(eez == "PG")
library(tidyverse)
my_eez <- filter(dat, eez == "PG")
head(my_eez)
# Sum up all the skipjack catch (column yftcatch) by year to see how catches of skipjack have changed in your EEZ over time
yft_catch <- my_eez %>% group_by(year) %>% summarise(Catch = sum(yftcatch))
yft_catch
# Make a bar plot showing catches over time
ggplot(yft_catch, aes(x = year, y = Catch)) + geom_bar(stat = "identity")
# Pretty it up
ggplot(yft_catch, aes(x = year, y = Catch)) + geom_bar(stat = "identity", fill = "orchid") + ggtitle("Yellowfin catch in my EEZ")
head(dat)
yft_catch <- my_eez %>% group_by(year, gear_name) %>% summarise(Catch = sum(yftcatch))
# Make a bar plot showing catches over time
ggplot(yft_catch, aes(x = year, y = Catch, fill = gear_name)) + geom_bar(stat = "identity")
shiny::runApp('C:/GitRep/WPEA-data-visuals')
runApp('C:/GitRep/WPEA-data-visuals')
32941*.54
32941*.65
32941*.75
32941*.8
setwd("C:/R_Courses/Moses")
5705+999.9+5022.6
11428.27+19.92+136.12+284.69
.54/.535
.54/.535*8000
.19/.185
6000/.87
5800/.765
5750*.78
7580*.765
4485+5798.7
5750+7580
13330*.77
13330*.775
13330*.78
13330*.785
52108*.22
.225/.22
40000*.22
50000*.22
29000*.24+2014*.225
7413/31014
31014*.245
29000*.24+2014*.225+10000*.23
9713/41014
41014*.24
5500/.23
54014*.235
54014*.24
54014*.245
6900*.895
6900*.87
54014*.23
54014*.235
54014*.24
54014*.245
5750*.01
.19/.18
18550+32941
51491*.545
51491*.65
51491*.75
133600+64600+.42*48000+35400/.93
runApp('C:/GitRep/WPEA-data-visuals')
51491*.8
63491*.545
63491*.7
63491*.75
63491*.8
429
341
286+429
341+180
.19/.185
50000/.92
6900*.87
6900*.89
6900*.91
6900*.915
runApp('C:/GitRep/WPEA-data-visuals')
library(shiny)
library(ggplot2)
library(shinyWidgets)
library(shinydashboard)
library(sf)
library(maps)
library(grid)
library(gridExtra)
library(ggthemes)
library(magrittr)
library(tidyverse)
library(rnaturalearth)
library(rnaturalearthdata)
theme_set(theme_bw())
sf_use_s2(FALSE)
world <- ne_countries(scale = "medium", returnclass = "sf")
load("./Data/All_a-best_data.RData")
load("./Data/All_lf-master-wpea_data.RData")
load("./Data/All_wf-master-wpea_data.RData")
runApp('C:/GitRep/WPEA-data-visuals')
